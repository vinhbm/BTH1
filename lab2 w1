USE [master]
GO
/****** Object:  Database [QLDA]    Script Date: 21/03/2023 5:00:18 PM ******/
CREATE DATABASE [QLDA]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'QLDA', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\QLDA.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'QLDA_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\QLDA_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
GO
ALTER DATABASE [QLDA] SET COMPATIBILITY_LEVEL = 140
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [QLDA].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [QLDA] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [QLDA] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [QLDA] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [QLDA] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [QLDA] SET ARITHABORT OFF 
GO
ALTER DATABASE [QLDA] SET AUTO_CLOSE ON 
GO
ALTER DATABASE [QLDA] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [QLDA] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [QLDA] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [QLDA] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [QLDA] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [QLDA] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [QLDA] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [QLDA] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [QLDA] SET  ENABLE_BROKER 
GO
ALTER DATABASE [QLDA] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [QLDA] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [QLDA] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [QLDA] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [QLDA] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [QLDA] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [QLDA] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [QLDA] SET RECOVERY SIMPLE 
GO
ALTER DATABASE [QLDA] SET  MULTI_USER 
GO
ALTER DATABASE [QLDA] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [QLDA] SET DB_CHAINING OFF 
GO
ALTER DATABASE [QLDA] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [QLDA] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [QLDA] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [QLDA] SET QUERY_STORE = OFF
GO
USE [QLDA]
GO
/****** Object:  Table [dbo].[CONGVIEC]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CONGVIEC](
	[MADA] [int] NOT NULL,
	[STT] [int] NOT NULL,
	[TEN_CONG_VIEC] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[MADA] ASC,
	[STT] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DEAN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DEAN](
	[TENDA] [nvarchar](15) NULL,
	[MADA] [int] NOT NULL,
	[DDIEM_DA] [nvarchar](15) NOT NULL,
	[PHONG] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MADA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DIADIEM_PHG]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DIADIEM_PHG](
	[MAPHG] [int] NOT NULL,
	[DIADIEM] [nvarchar](15) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MAPHG] ASC,
	[DIADIEM] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[NHANVIEN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[NHANVIEN](
	[HONV] [nvarchar](15) NULL,
	[TENLOT] [nvarchar](15) NULL,
	[TENNV] [nvarchar](15) NULL,
	[MANV] [nvarchar](9) NOT NULL,
	[NGSINH] [date] NULL,
	[DCHI] [nvarchar](30) NULL,
	[PHAI] [nvarchar](3) NULL,
	[LUONG] [float] NULL,
	[MA_NQL] [nvarchar](9) NULL,
	[PHG] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MANV] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PHANCONG]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PHANCONG](
	[MA_NVIEN] [nvarchar](9) NOT NULL,
	[MADA] [int] NOT NULL,
	[STT] [int] NOT NULL,
	[THOIGIAN] [float] NULL,
PRIMARY KEY CLUSTERED 
(
	[MA_NVIEN] ASC,
	[MADA] ASC,
	[STT] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PHONGBAN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PHONGBAN](
	[TENPHG] [nvarchar](15) NULL,
	[MAPHG] [int] NOT NULL,
	[TRPHG] [nvarchar](9) NULL,
	[NG_NHANCHUC] [date] NULL,
PRIMARY KEY CLUSTERED 
(
	[MAPHG] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[THANNHAN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[THANNHAN](
	[MA_NVIEN] [nvarchar](9) NOT NULL,
	[TENTN] [nvarchar](15) NOT NULL,
	[PHAI] [nvarchar](3) NULL,
	[NGSINH] [date] NULL,
	[QUANHE] [nvarchar](15) NULL,
PRIMARY KEY CLUSTERED 
(
	[MA_NVIEN] ASC,
	[TENTN] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[CONGVIEC]  WITH NOCHECK ADD  CONSTRAINT [FK_CONGVIEC_DEAN] FOREIGN KEY([MADA])
REFERENCES [dbo].[DEAN] ([MADA])
GO
ALTER TABLE [dbo].[CONGVIEC] CHECK CONSTRAINT [FK_CONGVIEC_DEAN]
GO
ALTER TABLE [dbo].[DEAN]  WITH NOCHECK ADD  CONSTRAINT [FK_DEAN_PHONG] FOREIGN KEY([PHONG])
REFERENCES [dbo].[PHONGBAN] ([MAPHG])
GO
ALTER TABLE [dbo].[DEAN] CHECK CONSTRAINT [FK_DEAN_PHONG]
GO
ALTER TABLE [dbo].[DIADIEM_PHG]  WITH NOCHECK ADD  CONSTRAINT [FK_DIADIEM_PHG_PHONGBAN] FOREIGN KEY([MAPHG])
REFERENCES [dbo].[PHONGBAN] ([MAPHG])
GO
ALTER TABLE [dbo].[DIADIEM_PHG] CHECK CONSTRAINT [FK_DIADIEM_PHG_PHONGBAN]
GO
ALTER TABLE [dbo].[NHANVIEN]  WITH NOCHECK ADD  CONSTRAINT [FK_NHANVIEN_NHANVIEN] FOREIGN KEY([MA_NQL])
REFERENCES [dbo].[NHANVIEN] ([MANV])
GO
ALTER TABLE [dbo].[NHANVIEN] CHECK CONSTRAINT [FK_NHANVIEN_NHANVIEN]
GO
ALTER TABLE [dbo].[NHANVIEN]  WITH NOCHECK ADD  CONSTRAINT [FK_NHANVIEN_PHONGBAN] FOREIGN KEY([PHG])
REFERENCES [dbo].[PHONGBAN] ([MAPHG])
GO
ALTER TABLE [dbo].[NHANVIEN] CHECK CONSTRAINT [FK_NHANVIEN_PHONGBAN]
GO
ALTER TABLE [dbo].[PHANCONG]  WITH NOCHECK ADD  CONSTRAINT [FK_PHANCONG_DEAN] FOREIGN KEY([MADA])
REFERENCES [dbo].[DEAN] ([MADA])
GO
ALTER TABLE [dbo].[PHANCONG] CHECK CONSTRAINT [FK_PHANCONG_DEAN]
GO
ALTER TABLE [dbo].[PHANCONG]  WITH NOCHECK ADD  CONSTRAINT [FK_PHANCONG_NHANVIEN] FOREIGN KEY([MA_NVIEN])
REFERENCES [dbo].[NHANVIEN] ([MANV])
GO
ALTER TABLE [dbo].[PHANCONG] CHECK CONSTRAINT [FK_PHANCONG_NHANVIEN]
GO
ALTER TABLE [dbo].[PHONGBAN]  WITH NOCHECK ADD  CONSTRAINT [FK_PHONGBAN_NHANVIEN] FOREIGN KEY([TRPHG])
REFERENCES [dbo].[NHANVIEN] ([MANV])
GO
ALTER TABLE [dbo].[PHONGBAN] CHECK CONSTRAINT [FK_PHONGBAN_NHANVIEN]
GO
ALTER TABLE [dbo].[THANNHAN]  WITH NOCHECK ADD  CONSTRAINT [FK_THANNHAN_NHANVIEN] FOREIGN KEY([MA_NVIEN])
REFERENCES [dbo].[NHANVIEN] ([MANV])
GO
ALTER TABLE [dbo].[THANNHAN] CHECK CONSTRAINT [FK_THANNHAN_NHANVIEN]
GO
/****** Object:  StoredProcedure [dbo].[SLNV]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[SLNV] @MADA int
as
select COUNT(PHANCONG.MA_NVIEN) from PHANCONG,DEAN
where PHANCONG.MADA = @MADA  AND DEAN.MADA = @MADA
GO
/****** Object:  StoredProcedure [dbo].[Tinhtong]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[Tinhtong] @s1 int, @s2 int
as
begin
declare @tg int
set @tg = @s2 + @s1
PRINT N'Tổng là: ' + str(@tg)
end
GO
/****** Object:  StoredProcedure [dbo].[TongChan]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[TongChan] @n int
as
declare @tong int, @a int
set @a=1
while (@a<=@n)
begin
if @a %2 =0
	set @tong=@tong+@a
	set @a=@a+1
end
print (N'Tong so chan tu 1 den ' +@n +N' la :'+@tong)
GO
/****** Object:  StoredProcedure [dbo].[UpdatePHONGBAN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[UpdatePHONGBAN] @CNTT nvarchar(15)
as
begin
update PHONGBAN
set TENPHG=@CNTT
end
GO
/****** Object:  StoredProcedure [dbo].[updPHONGBAN]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[updPHONGBAN]	@Tenphg nvarchar(15) , @Maphg int	
as
begin
insert into PHONGBAN(TENPHG,MAPHG)
values ( @Tenphg, @Maphg)
end
GO
/****** Object:  StoredProcedure [dbo].[updPHONGBAN1]    Script Date: 21/03/2023 5:00:18 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[updPHONGBAN1] @Tenphg nvarchar(15), @Maphg int
as
begin
update PHONGBAN
set TENPHG=@Tenphg
where MAPHG=@Maphg
end
GO
USE [master]
GO
ALTER DATABASE [QLDA] SET  READ_WRITE 
GO
